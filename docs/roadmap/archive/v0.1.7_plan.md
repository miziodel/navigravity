# v0.1.7 Release Plan: Stability & Discovery

**Status**: Active
**Target Date**: 2026-01-12
**Focus**: Critical Bug Fixes (Stability) + Infrastructure Upgrades (Capabilities)

## ðŸ”´ Priority 1: Critical Fixes (Blocking)
*Derived from Black Box Feedback*

### 1. ID Persistence & Stability (The "Ghost ID" Fix)
*   **Problem**: `assess_playlist_quality` fails with "Song not found" for IDs returned moments earlier.
*   **Context**: Breaks automation chains and verification steps.
*   **Solution**:
    *   Implement robust retry logic in `assess_playlist_quality` (refresh cache if ID missing).
    *   Change failure mode: Skip missing tracks with a warning instead of crashing the whole batch.
    *   Ensure all IDs are validated as 32-char hex strings before processing.

### 2. Strict Parameter Validation (The "Silent Mode" Fix)
*   **Problem**: `mode='top_rated'` silently ignores `mood` filters, returning contextually wrong tracks.
*   **Solution**:
    *   **Fail Fast**: Raise a descriptive error if incompatible parameters are combined (e.g., `top_rated` + `mood`).
    *   **Alternative**: Implement manual intersection if feasible, but erroring is safer to prevent hallucinations.

### 3. Search Reliability
*   **Problem**: Strict searches return `[]` for existing artists due to minor typos or formatting.
*   **Solution**:
    *   Implement `_fetch_search_results` helper.
    *   Add "Fuzzy Fallback": If strict search yields 0, auto-retry with relaxed terms or `search3` broadly.

---

## ðŸŸ¡ Priority 2: Infrastructure & Tools (Enhancement)
*Derived from Improvements Plan*

### 4. Advanced Discovery Tools
*   **New Tool**: `similar_tracks_by_fingerprint(track_id)` - Wraps `getSimilarSongs2` for acoustic similarity.
*   **New Tool**: `get_similar_artists(artist_name)` - Bridging widely separate artists.
*   **New Tool**: `batch_check_presence(artist_list)` - O(1) efficiency for large list checking.
*   **New Tool**: `search_by_tag(tags)` - Multi-genre "vibe" search.

### 5. Rediscovery Modes (in `get_smart_candidates`)
*   **`rediscover` (Album Archeology)**: Random albums instead of random songs (higher yield).
*   **`fallen_pillars`**: Scan top artists for tracks not played in >1 year.
*   **`similar_to_starred`**: Use starred tracks as seeds for similarity.

---

## ðŸŸ¢ Priority 3: Internal Cleanup
*   **Common Search Wrapper**: Unify all search calls under `_fetch_search_results` to centralize fuzzy logic and error handling.
*   **Version Bump**: Set `__version__ = "0.1.7"`.

## Verification Strategy
1.  **Reproduction Script**: Create a script that intentionally passes invalid IDs and mixed parameters to verify the new error handling.
2.  **Discovery Test**: Run the new `rediscover` modes and verify yield > 20 tracks.
